# Tarjan算法2 #

## 无向图的双连通分量 ##
	
### 介绍 ###

  		图的双连通分为点双连通和边双连通，在此仅讨论点双连通。
  
  		无向图的点双连通问题关键是看图中是否有关节点，找关节点的过程就是找双连通分量的过程。
  		没有关节点的图就称为双连通图。
  		关节点可以属于多个点双连通分支，其余点和每条边只属于且属于一个点双连通分支。
  		其中，关节点的含义是：无向图中任意两个顶点之间的每条路都包含顶点 A，则 A 称为关节点。
  
  		对图进行一次先深搜索就能求出所有的关节点，由先深生成树可以得出关节点的两个特性：
  		设关节点为 U
  		1. U 是树根，且 U 有多于一棵子树；
  		2. U 不是树根，也不是叶节点，其某株子树的根和子树中的其它节点均没有指向 U 的祖先的回退边。
  	
		如何用形式化的语言表示上述两个特性，将在下文讨论。
  

### 无向图双连通分量的Tarjan算法 ###
* **数据结构**

  图用邻接表形式存储，存储当前双连通分支的栈的结构为：
  ```c
  struct ele{
	  int father;
	  int child;
  };

  struct stack{
	  struct ele elements[maxsize];
	  int top;  
  };
  typedef struct stack * st;
  ```
  
  用到的几个全局变量：
  ```c
  int visited[maxsize];             //访问标记数组
  int count;                       //用于编号
  int sig;                        //用于标记连通分量的个数
  int num;                       //记录是第几个双连通分量
  int dfn[maxsize];             //顶点的先深编号         
  int father[maxsize];         //记录某个顶点的父节点的index
  int low[maxsize];
  ```

* **算法介绍**

		根据关节点的两个特性我们可以得出：
	
		定义DFN(u)为节点u的先深编号，Low(u)为u或u的子树能够追溯到的最早的栈中节点的次序号。

		由定义可以得出：

	> 	
		Low(u)=Min
		{
	  		DFN(u),
	>   	  	Low(v),(u,v)为树枝边，u为v的父节点
	>   	  	DFN(v),(u,v)为指向栈中节点的后向边
		}
	
	
      	则有 DFN(u) < Low(v) 关系的顶点 u 就是关节点，其中(u,v)是树枝边即 u 是 v 的父亲。
	
      	在先深搜索过程中按后根顺序计算 low 数组，
      	即计算所有顶点 v 的 low[v] 编号是在深度优先生成树上按后根顺序遍历进行的。
	
		算法的基本过程为：
	
		建立一个栈，存储当前双连通分支。
		在搜索图时，每找到一条树枝边或后向边(非横叉边)，就把这条边加入栈中。
		如果遇到某时满足 DFN(u) <= Low(v)，说明u是一个割点，
		同时把边从栈顶一个个取出，直到遇到了边(u,v)，取出的这些边与其关联的点，组成一个点双连通分支。
	
  
* **和有向图的强连通分量求解过程比较**

		两者本质上是一样的，都是Tarjan 算法，不同的地方是：
	
		1.栈结构不同，双连通栈中存的是边，强连通栈中存的是顶点;
	
		2.由于栈结构不同，所以是否入栈的判断条件也不一样，强连通是直接将顶点入栈即可，
	
		但是双连通得按以下条件判断边是否已经在栈中
 ```c
 if (!(dfn[u] < dfn[w] && visited[w] == 1) &&
	 !(dfn[u] > dfn[w] && father[u] == w)){
		 s->elements[s->top].father = u;
		 s->elements[s->top].child = w;
		 s->top++;
	 	 father[w] = u;
 }
 ```
 		判断是否为回退边的条件也因此不一样。
 	
		3.求得解的条件不一样，双连通是 DFN(u) <= Low(v)，强连通是 DFN(u) = Low(u)。
  

### 复杂度分析 ###

		运行Tarjan算法的过程中，每个顶点都被访问了一次，且只进出了一次堆栈，每条边也只被访问了一次；
	
		所以时间复杂度：O(V+E)，其中V为顶点个数，E为边的个数
        
## 扩展 ##
		类似地可以求图的边双连通分量，还能将非双连通图通过加边构造成双连通图等等。

## 参考文献 ##

[Beyond the Void 图的割点、桥与双连通分支](https://www.byvoid.com/blog/biconnect/)

