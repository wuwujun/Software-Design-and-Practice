# Tarjan算法1 #

## 有向图的强连通分量 ##
### 介绍 ###
    
>  
  以下内容引自[Kosaraju 算法 互动百科](http://www.baike.com/wiki/Kosaraju%E7%AE%97%E6%B3%95)
>
  什么是强连通分量？

>  
  在这之前先定义一个强连通性（strong connectivity）的概念：有向图中，如果一个顶点s到t有一条路径，t到s也有一条路径，即s与t互相可达，
  那么我们说s与t是强连通的。那么在有向图中，由互相强连通的顶点构成的分量，称作强连通分量。
  
>
  关于强连通分量的一些预备条件：
>  
  证明： 一，按照有向图的约定，每个顶点都有到达自身的路径，即自环，即任意顶点s到s可达，满足自反性； 
> 
  二，如果s与t是强连通的，则s到t存在路径，t到s存在路径，显然t与s也是强连通的，满足对称性； 
> 
  三，如果r与s强连通，s与t强连通，则r与s互相可达，s与t互相可达，显然r与t也互相可达，满足传递性。
>
  因此，强连通关系可导出一个等价类，这就是强连通分量。
  进一步的利用这结论可以知道，两个强连通分量之间没有交集（这个结论很重要）。
  事实上，图论与离散数学中的“关系”有非常密切的关系。 
  
      可见，一个强连通有向图的强连通分量就是它自身，而一个非强连通有向图可以划分成若干个强连通分量。  
    
### 有向图强连通分量的Tarjan算法 ###
      相比于双向遍历取交集的算法和Kosaraju算法，Tarjan算法实际上就是利用栈的回溯过程替代第二遍遍历，
  
      所以只需要一遍深度优先搜索即可达到目的。
    
      进行一遍先深搜索可以将有向图中的边分为三类：
  
      横边：连接到已经出栈的节点的边；
  
      回退边：连接到已在栈中节点的边；
  
      树枝边:在搜索树中的边；

* **算法介绍**

  进行先深搜索时，将遍历到的节点加入一个堆栈，在遍历的同时计算Low(u)，回溯时据此可以判断栈顶到栈中的节点是否为一个强连通分量。
    
  定义DFN(u)为节点u的先深编号，Low(u)为u或u的子树能够追溯到的最早的栈中节点的次序号。
  
  由定义可以得出：
  
  > 
      Low(u)=Min
      {
          DFN(u),
          Low(v),(u,v)为树枝边，u为v的父节点
          DFN(v),(u,v)为指向栈中节点的回退边
      }
    
    当DFN(u)=Low(u)时，以u为根的搜索子树上所有节点是一个强连通分量。
    
### 复杂度分析 ###
        
      运行Tarjan算法的过程中，每个顶点都被访问了一次，且只进出了一次堆栈，每条边也只被访问了一次；
  
      所以时间复杂度：O(V+E)，其中V为顶点个数，E为边的个数
 

## 参考文献 ##

[Beyond the Void 有向图强连通分量的Tarjan算法](https://www.byvoid.com/blog/scc-tarjan)
